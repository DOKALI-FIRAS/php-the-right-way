---
title: مشكلة معقدة
isChild: true
anchor:  complex_problem
---

## مشكلة معقدة {#complex_problem_title}

إذا كنت قرأت عن حقن التوابع سابقاً ربما يكون قد لفت انتباهك مصطلح *"Inversion of Control"* انعكاس التحكم أو *"Dependency Inversion Principle"* مفهوم عكس تحكم التوابع.
هذه المشاكل المعقدة التي يقوم حقن التوابع بحلها.

### انعكاس التحكم

انعكاس التحكم، كما يعبر عنه اسمه، هو إبقاء التحكم التنظيمي للنظام بالكامل بمنئى عن العناصر أو الكائنات. في مصطلح حقن التوابع هذا يعني فك الإرتباط مع التوابع وعكس التحكم بهذه التوابع في مكان آخر في النظام.

لعدة سنين، أُطر العمل في لغة PHP تستخدم عكس التحكم ولكن يبقى السؤال: أي جزء من التحكم هو الذي تقوم بعكسه؟ وإلى أين؟
مثلا أُطر العمل بنموذج MVC تقدم بشكل عام كائن أساسي أو متحكم أساسي يجب على المتحكمات الفرعية الأخرى أن تستمد منه لكي
تَصِلَ إلى توابعه. هذا **هو** عكس التحكم، لكن عوضاً عن فك ارتباط التوابع هذه الطريقة تقوم بترحيلهم.

حقن التوابع يتيح لنا حل هذه المشكلة بسلاسة، فقط عن طريق حقن التوابع التي نريد عندما نحتاجها دون الحاجة لأي كتابة صريحة
لأي تابع في المصدر على الإطلاق.

### مفهوم عكس التحكم

مفهوم عكس التحكم هو حرف "D" في مجموعة مفاهيم البرمجة الشيئية S.O.L.I.D  والذي ينص على أنه يجب *"الإعتماد على التجريد، لا على
التحجير أو الإنغلاق"*. بوضوح هذا يعني أن التوابع في برنامجنا يجب أن تكون واجهات أو مجردات عوضاً عن التطبيقات الجامدة أو المحجرة. عندها
يمكننا بسهولة إعادة صياغة وكتابة المفهوم أعلاه:

{% highlight php %}
<?php
namespace Database;

class Database
{
    protected $adapter;

    public function __construct(AdapterInterface $adapter)
    {
        $this->adapter = $adapter;
    }
}

interface AdapterInterface {}

class MysqlAdapter implements AdapterInterface {}
{% endhighlight %}

هنالك عدة فوائد يستفيد منها صنف `Database` الآن، فهوالآن يعتمد على واجهة بدلاً من كائن جامد.

ضع بالإعتبار أنك تعمل ضمن فريق وأن المحول يعمل عليه أحد الزملاء. في المثال الأول يجب أن نقوم بانتظار زميلنا حتى يخبرنا بأنه قد انتهى من المحول حتى يَتَسَنَّى لنا الإعتماد عليه في وحدة اختبارات. الآن التابع هو عبارة عن واجهة يمكننا الإعتماد عليها بأعتبار أن زميلنا سيقوم ببناء المحول وفق الواجهة المحددة.

فائدة أكبر وهي أن هذه الطريقة تجعل الشفرة البرمجية قابلة للتطوير. فمثلا بعد سنة قررنا أن نقوم بالترحيل إلى نوع آخر من أنواع قواعد البيانات، يمكن أن نقوم بكتابة محول يتبع شروط الواجهة الأصلية ثم يحقن عوضاً عن ذلك، لا حاجة لمزيد من التعديل أو إعادة صياغة،  ويمكن الجزم بأن ذلك المحول الجديد يتبع الشروط الموضوعة من قبل الواجهة.
