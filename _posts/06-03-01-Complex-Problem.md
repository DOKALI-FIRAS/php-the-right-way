---
title: مشكلة معقدة
isChild: true
anchor:  complex_problem
---

## مشكلة معقدة {#complex_problem_title}

إذا كنت قرأت عن حقن التوابع سابقاً قد يكون لفت نتباهك مصطلح *"Inversion of Control"* انعكاس التحكم أو *"Dependency Inversion Principle"* مفهوم عكس تحكم التوابع.
هذه المشاكل المعقدة هي ما يقوم حقن التوابع بحلها.

### انعكاس التحكم

انعكاس التحكم كما يدل عليها الاسم هو إبقاء التحكم التنظيمي بالكامل بمنئى عن العناصر أو الكائنات. في مصطلح حقن التوابع هذا يعني فك الإرتباط مع التوابع وعكس التحكم بهذه التوابع في مكان آخر في النظام.

طوال عدة سنين، أطر النظام في PHP تستخدم عكس التحكم، ولكن يبقى السؤال: أي جزء من التحكم هو الذي تقوم بعكسه؟ وإلى أين؟
مثلا أطر العمل بنموذج MVC تقدم بشكل عام كائن أساسي أو متحكم أساسي يجب على المتحكمات الفرعية الأخرى أن تستمد منه لكي تحصل على وصول لتوابعه.
هذا **هو** عكس التحكم، لكن عوضاً عن فك ارتباط التوابع هذه الطريقة تقوم بترحيلهم.

حقن التوابع يتيح لنا حل هذه المشكلة بسلاسة عن طريق حقن التوابع التي نريد عند الحاجة، دون الحاجة لأي كتابة صريحة لأي تابع في المصدر على الإطلاق.

### مفهوم عكس التحكم

مفهوم عكس التحكم هو حرف "D" في مجموعة مفاهيم البرمجة الشيئية S.O.L.I.D  وينص على أنه يجب *"الإعتماد على التجريد، لا على التحجير أو الإنغلاق"*. هذا يعني أن التوابع يجب أن تكون واجهات أو مجردات عوضاً عن التطبيقات الجامدة أو المحجرة. عندها
يمكننا إعادة صياغة وكتابة المفهوم أعلاه بسهولة:

{% highlight php %}
<?php
namespace Database;

class Database
{
    protected $adapter;

    public function __construct(AdapterInterface $adapter)
    {
        $this->adapter = $adapter;
    }
}

interface AdapterInterface {}

class MysqlAdapter implements AdapterInterface {}
{% endhighlight %}

هنالك عدة فوائد يستفيد منها صنف `Database` الآن، فهوالآن يعتمد على واجهة بدلاً من كائن جامد.

ضع بالإعتبار أنك تعمل ضمن فريق وأن أحد الزملاء يقوم بالعمل على المحول. في المثال الأول يجب أن نقوم بانتظار زميلنا حتى يخبرنا بأنه قد انتهى من المحول حتى يتسنى لنا الاعتماد عليه في إختبار الوحدة. الآن التابع هو عبارة عن واجهة يمكننا أن
نعتمد عليها باعتبار أن زميلنا سيقوم ببناء المحول وفق الواجهة المحددة.

فائدة أكبر وهي أن هذه الطريقة تجعل المصدر قابل للتطوير. فمثلا بعد سنة قررنا أن نقوم بالترحيل إلى نوع آخر من قواعد البيانات، يمكن أن نقوم بكاتبة محول يتبع شروط الواجهة الأصلية ثم يحقن عوضاً عنه. عندها لا يوجد تعديل أو إعادة صياغة ويمكن أن نجزم بأن ذلك
المحول الجديد يتبع الشروط الموضوعة من قبل الواجهة.
